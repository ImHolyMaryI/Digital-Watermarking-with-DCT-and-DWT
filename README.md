# Digital Watermarking with DCT and DWT

## Описание

Этот проект реализует метод цифрового водяного знака с использованием дискретного косинусного преобразования (DCT) и дискретного вейвлет-преобразования (DWT). Он предназначен для внедрения и извлечения водяного знака из изображений, что может быть полезно для защиты авторских прав и проверки подлинности изображений.

## Установка

Для запуска проекта вам нужно установить несколько зависимостей. Убедитесь, что у вас установлены Python и pip. Затем выполните следующие команды:

```bash
pip install numpy
pip install pywt
pip install pillow
pip install scipy 
```

## Использование

Подготовка изображений
1. Поместите изображение, в которое вы хотите внедрить водяной знак, в папку `./pictures/.` Убедитесь, что изображение имеет разрешение 2048x2048 пикселей.
2. Поместите водяной знак (в формате PNG) в ту же папку.

## Запуск проекта
Для использования проекта измените значения переменных `image` и `watermark` в нижеследующем коде и запустите его:

``` python 
from DigitalWatermarkDctDwt import DigitalWatermarkDctDwt

image = 'pestrunia.jpg'  # Имя изображения
watermark = 'qr-code.png'  # Имя водяного знака

wm = DigitalWatermarkDctDwt(image, watermark)
wm.implementation_dw()  # Внедрение водяного знака
wm.recover_watermark()  # Восстановление водяного знака
```
## Результаты
После выполнения скрипта:

В папке `./dataset/` будет сохранено изображение с водяным знаком.
В папке `./result/` будут сохранены результаты, включая изображение с водяным знаком и извлечённый водяной знак.

## Описание кода

### Основные компоненты

Функция `convert_image(image_name: str, size: int) -> np.ndarray` Преобразует изображение в массив NumPy, изменяя его размер на size x size.  

Класс `DigitalWatermarkDctDwt`: Реализует методы для внедрения и извлечения водяного знака:

`__init__()` — инициализация с изображением и водяным знаком.  


`__process_coefficients()` — процесс декомпозиции изображения на коэффициенты.  


`__apply_dct()` — применение DCT к изображению.  


`__embed_watermark()` — внедрение водяного знака в изображение.  


`__inverse_dct()` — восстановление изображения из DCT-коэффициентов.  


`__print_image_from_array()` — сохранение изображения из массива данных. 


`__get_watermark()` — извлечение водяного знака из DCT-коэффициентов.  


`__recover_watermark()` — восстановление водяного знака из изображения.  


`implementation_dw()` — внедрение водяного знака в изображение.  


`recover_watermark()` — восстановление водяного знака.  

## Примечания

Убедитесь, что ваши изображения имеют соответствующие размеры (2048x2048 для основного изображения и 128x128 для водяного знака) для правильной работы скрипта.  

Если требуется использовать другие модели вейвлетов, измените параметр model в конструкторе класса `DigitalWatermarkDctDwt`.

